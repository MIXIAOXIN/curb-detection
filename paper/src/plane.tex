Given the responsibilities $\gamma_{ik}$, i.e. $p(l_i=k)$, for each grid cell
$\mathcal{C}_i$, we show in this Section the derivations that lead to the
estimation of an updated parameter set $\Theta^\text{new}$ using a modified
linear regression framework.

The mixture weights are simply updated as follows:

\begin{equation}
\label{eqn:weights}
\pi_k = \frac{1}{M'}\sum_{i=1}^{M'}\gamma_{ik}.
\end{equation}

The MLE of the other parameters are determined by maximizing the
\emph{complete-data} log likelihood, i.e. $\log p(\mathbf{h}\mid\Theta)$, where
$\mathbf{h}=[h_1,h_2,\dots,h_{M'}]^\text{T}$.

The updated regression coefficients are computed as follows:

\begin{equation}
\label{eqn:coeff}
\mathbf{w}_k = (\boldsymbol{\Phi}\mathbf{R}_k\boldsymbol{\Phi})^{-1}
\boldsymbol{\Phi}^\text{T}\mathbf{R}_k\mathbf{h},
\end{equation}

where $\mathbf{R}_k=\text{diag}(\gamma_{ik})$ is a diagonal matrix and
$\boldsymbol{\Phi}=[\boldsymbol{\phi}(\mathbf{c}_1), \boldsymbol{\phi}
(\mathbf{c}_2),\dots,\boldsymbol{\phi}(\mathbf{c}_{M'})]^\text{T}$ is the
\emph{design matrix}.

Finally, the regression variances are modified as

\begin{equation}
\label{eqn:coeff}
\sigma^2_k = \frac{1}{M'}\sum_{i=1}^{M'} \gamma_{ik}(h_i-\mathbf{w}_k^\text{T}
\boldsymbol{\phi}(\mathbf{c}_i))^2.
\end{equation}

The attentive reader might notice that, apart from the introduction of
$\mathbf{R}_k$, these derivations are close to the case of the single linear
regression. The responsibilities act here as a weight to the computations, that
is, they control the degree of influence of a particular point to the
plane regression.
